<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <!-- 
        This Liquibase file is meant to contain changesets for USERS and roles required by the system OpenMRS/Bahmni.
    -->
    <changeSet id="SAMPLE-OMRS-USERS-001" author="tw">
        <comment>Adding deafult user</comment>
        <sql>
            set @puuid = uuid();
            INSERT INTO person(birthdate_estimated, dead, creator, date_created, uuid) VALUES(0, 0, 1, now(), @puuid);
            INSERT INTO person_name(person_id, preferred, given_name, family_name, creator, date_created, uuid) VALUES((select person_id from person where uuid = @puuid), 1, 'Super', 'Man', 1, now(), @puuid);
            INSERT INTO users(system_id, creator, date_created, person_id, uuid, username, password, salt) VALUES ('superman', 1, now(),(select person_id from person where uuid = @puuid), uuid(), 'superman', 'e28e3ae84c66bfba6b2c50a406567f3e34fea1d76b17c006931571fe5d940f6c6b81e49cf8ea5e0adfca19fe3beb68d8ad79f7c3812e92b8d502a9afcf2029b2', '1c9d7e94aeeb7a2459ef45ed200b2944582e0e7088d75f9b57a3644861ea766c20a269b3fe2eadaff1bc445ecfbd9bd3c0c550dfd813de48d39423cd3d1a8b10');
            INSERT INTO provider (person_id, identifier, creator, date_created, uuid, name) VALUES ((select person_id from person where uuid = @puuid), 'superman', 1, now(), uuid(), 'superman');
        </sql>
    </changeSet>
    <changeSet id="SAMPLE-OMRS-USERS-002" author="tw">
        <comment>Add new roles</comment>
        <insert tableName="role">
            <column name="role" value="Doctor" />
            <column name="description" value="Role for the doctor"/>
            <column name="uuid" valueComputed="uuid()" />
        </insert>
        <insert tableName="role">
            <column name="role" value="Nurse" />
            <column name="description" value="Role for the nurse"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
    </changeSet>
    <changeSet id="SAMPLE-OMRS-USERS-003" author="tw">
        <comment>Add privileges</comment>
        <insert tableName="privilege">
            <column name="privilege" value="Discharge Summary"/>
            <column name="description" value="Discharge Summary Privilege"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
        <insert tableName="privilege">
            <column name="privilege" value="app:clinical:history"/>
            <column name="description" value="JSS observation history view and edit"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
        <insert tableName="privilege">
            <column name="privilege" value="app:clinical:diagnosisTab"/>
            <column name="description" value="View and Edit Diagnosis tab"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
        <insert tableName="privilege">
            <column name="privilege" value="app:clinical:dispositionTab"/>
            <column name="description" value="View Disposition tab"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
        <insert tableName="privilege">
            <column name="privilege" value="app:clinical:observationTab"/>
            <column name="description" value="View Disposition tab"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
        <insert tableName="privilege">
            <column name="privilege" value="app:clinical:consultationTab"/>
            <column name="description" value="View Disposition tab"/>
            <column name="uuid" valueComputed="uuid()"/>
        </insert>
    </changeSet>
    <changeSet id="SAMPLE-OMRS-USERS-004" author="tw">
        <comment>Adding doctor, nurse roles</comment>
        <sql>
            insert into role_privilege (role, privilege) values ('Doctor', 'Add Encounters');
            insert into role_privilege (role, privilege) values ('Doctor', 'Add Observations');
            insert into role_privilege (role, privilege) values ('Doctor', 'Add Orders');
            insert into role_privilege (role, privilege) values ('Doctor', 'Add Patient Identifiers');
            insert into role_privilege (role, privilege) values ('Doctor', 'Add Patients');
            insert into role_privilege (role, privilege) values ('Doctor', 'Add People');
            insert into role_privilege (role, privilege) values ('Doctor', 'Add Visits');
            insert into role_privilege (role, privilege) values ('Doctor', 'app:clinical');
            insert into role_privilege (role, privilege) values ('Doctor', 'Delete Orders');
            insert into role_privilege (role, privilege) values ('Doctor', 'Delete Patients');
            insert into role_privilege (role, privilege) values ('Doctor', 'Delete Visits');
            insert into role_privilege (role, privilege) values ('Doctor', 'Discharge Summary');
            insert into role_privilege (role, privilege) values ('Doctor', 'Edit Encounters');
            insert into role_privilege (role, privilege) values ('Doctor', 'Edit Observations');
            insert into role_privilege (role, privilege) values ('Doctor', 'Edit Orders');
            insert into role_privilege (role, privilege) values ('Doctor', 'Edit Patient Identifiers');
            insert into role_privilege (role, privilege) values ('Doctor', 'Edit Patients');
            insert into role_privilege (role, privilege) values ('Doctor', 'Edit People');
            insert into role_privilege (role, privilege) values ('Doctor', 'Edit Users');
            insert into role_privilege (role, privilege) values ('Doctor', 'Edit Visits');
            insert into role_privilege (role, privilege) values ('Doctor', 'Patient Dashboard - View Demographics Section');
            insert into role_privilege (role, privilege) values ('Doctor', 'Patient Dashboard - View Encounters Section');
            insert into role_privilege (role, privilege) values ('Doctor', 'Patient Dashboard - View Forms Section');
            insert into role_privilege (role, privilege) values ('Doctor', 'Patient Dashboard - View Graphs Section');
            insert into role_privilege (role, privilege) values ('Doctor', 'Patient Dashboard - View Overview Section');
            insert into role_privilege (role, privilege) values ('Doctor', 'Patient Dashboard - View Patient Summary');
            insert into role_privilege (role, privilege) values ('Doctor', 'Patient Dashboard - View Regimen Section');
            insert into role_privilege (role, privilege) values ('Doctor', 'Patient Dashboard - View Visits Section');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Concept Classes');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Concept Datatypes');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Concept Map Types');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Concept Reference Terms');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Concept Sources');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Concepts');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Encounter Roles');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Encounter Types');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Encounters');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Locations');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Observations');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Order Types');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Orders');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Patient Identifiers');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Patients');
            insert into role_privilege (role, privilege) values ('Doctor', 'View People');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Person Attribute Types');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Privileges');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Providers');
            insert into role_privilege (role, privilege) values ('Doctor', 'View RESTWS');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Roles');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Users');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Visit Attribute Types');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Visit Types');
            insert into role_privilege (role, privilege) values ('Doctor', 'View Visits');
            insert into role_privilege (role, privilege) values ('Doctor', 'app:clinical:history');
            insert into role_privilege (role, privilege) values ('Doctor', 'app:clinical:diagnosisTab');
            insert into role_privilege (role, privilege) values ('Doctor', 'app:clinical:dispositionTab');
            insert into role_privilege (role, privilege) values ('Doctor', 'app:clinical:observationTab');
            insert into role_privilege (role, privilege) values ('Doctor', 'app:clinical:consultationTab');
            insert into role_privilege (role, privilege) values ('Doctor', 'Manage Encounter Roles');

            insert into role_privilege (role, privilege) values ('Nurse', 'Add Encounters');
            insert into role_privilege (role, privilege) values ('Nurse', 'Add Observations');
            insert into role_privilege (role, privilege) values ('Nurse', 'Add Orders');
            insert into role_privilege (role, privilege) values ('Nurse', 'Add Patient Identifiers');
            insert into role_privilege (role, privilege) values ('Nurse', 'Add Patients');
            insert into role_privilege (role, privilege) values ('Nurse', 'Add People');
            insert into role_privilege (role, privilege) values ('Nurse', 'Add Visits');
            insert into role_privilege (role, privilege) values ('Nurse', 'app:adt');
            insert into role_privilege (role, privilege) values ('Nurse', 'app:clinical');
            insert into role_privilege (role, privilege) values ('Nurse', 'Delete Orders');
            insert into role_privilege (role, privilege) values ('Nurse', 'Delete Patients');
            insert into role_privilege (role, privilege) values ('Nurse', 'Delete Visits');
            insert into role_privilege (role, privilege) values ('Nurse', 'Discharge Summary');
            insert into role_privilege (role, privilege) values ('Nurse', 'Edit Encounters');
            insert into role_privilege (role, privilege) values ('Nurse', 'Edit Observations');
            insert into role_privilege (role, privilege) values ('Nurse', 'Edit Orders');
            insert into role_privilege (role, privilege) values ('Nurse', 'Edit Patient Identifiers');
            insert into role_privilege (role, privilege) values ('Nurse', 'Edit Patients');
            insert into role_privilege (role, privilege) values ('Nurse', 'Edit People');
            insert into role_privilege (role, privilege) values ('Nurse', 'Edit Users');
            insert into role_privilege (role, privilege) values ('Nurse', 'Edit Visits');
            insert into role_privilege (role, privilege) values ('Nurse', 'Patient Dashboard - View Demographics Section');
            insert into role_privilege (role, privilege) values ('Nurse', 'Patient Dashboard - View Encounters Section');
            insert into role_privilege (role, privilege) values ('Nurse', 'Patient Dashboard - View Forms Section');
            insert into role_privilege (role, privilege) values ('Nurse', 'Patient Dashboard - View Graphs Section');
            insert into role_privilege (role, privilege) values ('Nurse', 'Patient Dashboard - View Overview Section');
            insert into role_privilege (role, privilege) values ('Nurse', 'Patient Dashboard - View Patient Summary');
            insert into role_privilege (role, privilege) values ('Nurse', 'Patient Dashboard - View Regimen Section');
            insert into role_privilege (role, privilege) values ('Nurse', 'Patient Dashboard - View Visits Section');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Concept Classes');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Concept Datatypes');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Concept Map Types');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Concept Reference Terms');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Concept Sources');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Concepts');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Encounter Roles');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Encounter Types');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Encounters');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Locations');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Observations');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Order Types');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Orders');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Patient Identifiers');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Patients');
            insert into role_privilege (role, privilege) values ('Nurse', 'View People');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Person Attribute Types');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Privileges');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Providers');
            insert into role_privilege (role, privilege) values ('Nurse', 'View RESTWS');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Roles');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Users');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Visit Attribute Types');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Visit Types');
            insert into role_privilege (role, privilege) values ('Nurse', 'View Visits');
            insert into role_privilege (role, privilege) values ('Nurse', 'app:clinical:observationTab');
            insert into role_privilege (role, privilege) values ('Nurse', 'app:clinical:consultationTab');
            insert into role_privilege (role, privilege) values ('Nurse', 'Manage Encounter Roles');
        </sql>
    </changeSet>
    <changeSet id="SAMPLE-OMRS-USERS-005" author="tw">
        <comment>Add roles to superman user</comment>
        <sql>
            SELECT user_id INTO @user_id FROM users where username = 'superman';
            INSERT INTO user_role(user_id, role) VALUES(@user_id, 'Provider');
            INSERT INTO user_role(user_id, role) VALUES(@user_id, 'System Developer');        
        </sql>
    </changeSet>
    <changeSet id="SAMPLE-OMRS-USERS-006" author="tw">
        <comment>Add roles to superman user</comment>
        <sql>
            SELECT user_id INTO @user_id FROM users where username = 'superman';
            INSERT INTO user_role(user_id, role) VALUES(@user_id, 'Doctor');
            INSERT INTO user_role(user_id, role) VALUES(@user_id, 'Nurse');        
        </sql>
    </changeSet>
    <changeSet id="SAMPLE-OMRS-USERS-007" author="tw">
        <comment>Add roles to superman user</comment>
        <sql>
            SELECT user_id INTO @user_id FROM users where username = 'superman';
            INSERT INTO user_role(user_id, role) VALUES(@user_id, 'bahmni-document-uploader');
            INSERT INTO user_role(user_id, role) VALUES(@user_id, 'RegistrationClerk');        
        </sql>
    </changeSet>
</databaseChangeLog>